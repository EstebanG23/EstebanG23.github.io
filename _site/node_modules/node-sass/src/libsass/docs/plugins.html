<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>estebang23.github.io</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="estebang23.github.io" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/node_modules/node-sass/src/libsass/docs/plugins.html" />
<meta property="og:url" content="http://localhost:4000/node_modules/node-sass/src/libsass/docs/plugins.html" />
<meta property="og:site_name" content="estebang23.github.io" />
<script type="application/ld+json">
{"@type":"WebPage","url":"http://localhost:4000/node_modules/node-sass/src/libsass/docs/plugins.html","headline":"estebang23.github.io","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=08194154e5c3f87742365edb210c0599bab19902">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">estebang23.github.io</a></h1>
      

      <p>Plugins are shared object files (.so on *nix and .dll on win) that can be loaded by LibSass on runtime. Currently we only provide a way to load internal/custom functions from plugins. In the future we probably will also add a way to provide custom importers via plugins (needs more refactoring to <a href="https://github.com/sass/libsass/issues/962">support multiple importers with some kind of priority system</a>).</p>

<h2 id="plugincpp">plugin.cpp</h2>

<pre><code class="language-C++">#include &lt;cstring&gt;
#include &lt;iostream&gt;
#include &lt;stdint.h&gt;
#include "sass_values.h"

union Sass_Value* ADDCALL call_fn_foo(const union Sass_Value* s_args, void* cookie)
{
  // we actually abuse the void* to store an "int"
  return sass_make_number((intptr_t)cookie, "px");
}

extern "C" const char* ADDCALL libsass_get_version() {
  return libsass_version();
}

extern "C" Sass_C_Function_List ADDCALL libsass_load_functions()
{
  // allocate a custom function caller
  Sass_C_Function_Callback fn_foo =
    sass_make_function("foo()", call_fn_foo, (void*)42);
  // create list of all custom functions
  Sass_C_Function_List fn_list = sass_make_function_list(1);
  // put the only function in this plugin to the list
  sass_function_set_list_entry(fn_list, 0, fn_foo);
  // return the list
  return fn_list;
}
</code></pre>

<p>To compile the plugin you need to have LibSass already built as a shared library (to link against it). The commands below expect the shared library in the <code class="highlighter-rouge">lib</code> sub-directory (<code class="highlighter-rouge">-Llib</code>). The plugin and the main LibSass process should “consume” the same shared LibSass library on runtime. It will propably also work if they use different LibSass versions. In this case we check if the major versions are compatible (i.e. 3.1.3 and 3.1.1 would be considered compatible).</p>

<h2 id="compile-with-gcc-on-linux">Compile with gcc on linux</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>g++ <span class="nt">-O2</span> <span class="nt">-shared</span> plugin.cpp <span class="nt">-o</span> plugin.so <span class="nt">-fPIC</span> <span class="nt">-Llib</span> <span class="nt">-lsass</span>
</code></pre></div></div>

<h2 id="compile-with-mingw-on-windows">Compile with mingw on windows</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>g++ <span class="nt">-O2</span> <span class="nt">-shared</span> plugin.cpp <span class="nt">-o</span> plugin.dll <span class="nt">-Llib</span> <span class="nt">-lsass</span>
</code></pre></div></div>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
