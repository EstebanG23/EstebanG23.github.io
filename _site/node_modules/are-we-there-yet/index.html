<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>are-we-there-yet | estebang23.github.io</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="are-we-there-yet" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/node_modules/are-we-there-yet/" />
<meta property="og:url" content="http://localhost:4000/node_modules/are-we-there-yet/" />
<meta property="og:site_name" content="estebang23.github.io" />
<script type="application/ld+json">
{"@type":"WebPage","url":"http://localhost:4000/node_modules/are-we-there-yet/","headline":"are-we-there-yet","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=08194154e5c3f87742365edb210c0599bab19902">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">estebang23.github.io</a></h1>
      

      <h2 id="are-we-there-yet">are-we-there-yet</h2>

<p>Track complex hiearchies of asynchronous task completion statuses.  This is
intended to give you a way of recording and reporting the progress of the big
recursive fan-out and gather type workflows that are so common in async.</p>

<p>What you do with this completion data is up to you, but the most common use case is to
feed it to one of the many progress bar modules.</p>

<p>Most progress bar modules include a rudamentary version of this, but my
needs were more complex.</p>

<h1 id="usage">Usage</h1>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">TrackerGroup</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"are-we-there-yet"</span><span class="p">).</span><span class="nx">TrackerGroup</span>

<span class="kd">var</span> <span class="nx">top</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TrackerGroup</span><span class="p">(</span><span class="s2">"program"</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">single</span> <span class="o">=</span> <span class="nx">top</span><span class="p">.</span><span class="nx">newItem</span><span class="p">(</span><span class="s2">"one thing"</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="nx">single</span><span class="p">.</span><span class="nx">completeWork</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">top</span><span class="p">.</span><span class="nx">completed</span><span class="p">())</span> <span class="c1">// 0.2</span>

<span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span><span class="p">(</span><span class="s2">"file"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">er</span><span class="p">,</span> <span class="nx">stat</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">er</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">er</span>  
  <span class="kd">var</span> <span class="nx">stream</span> <span class="o">=</span> <span class="nx">top</span><span class="p">.</span><span class="nx">newStream</span><span class="p">(</span><span class="s2">"file"</span><span class="p">,</span> <span class="nx">stat</span><span class="p">.</span><span class="nx">size</span><span class="p">)</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">top</span><span class="p">.</span><span class="nx">completed</span><span class="p">())</span> <span class="c1">// now 0.1 as single is 50% of the job and is 20% complete</span>
                              <span class="c1">// and 50% * 20% == 10%</span>
  <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="s2">"file"</span><span class="p">).</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">stream</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s2">"data"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">chunk</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do stuff with chunk</span>
  <span class="p">})</span>
  <span class="nx">top</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"change"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// called each time a chunk is read from "file"</span>
    <span class="c1">// top.completed() will start at 0.1 and fill up to 0.6 as the file is read</span>
  <span class="p">})</span>
<span class="p">})</span>
</code></pre></div></div>

<h1 id="shared-methods">Shared Methods</h1>

<ul>
  <li>var completed = tracker.completed()</li>
</ul>

<p>Implemented in: <code class="highlighter-rouge">Tracker</code>, <code class="highlighter-rouge">TrackerGroup</code>, <code class="highlighter-rouge">TrackerStream</code></p>

<p>Returns the ratio of completed work to work to be done. Range of 0 to 1.</p>

<ul>
  <li>tracker.finish()</li>
</ul>

<p>Implemented in: <code class="highlighter-rouge">Tracker</code>, <code class="highlighter-rouge">TrackerGroup</code></p>

<p>Marks the tracker as completed. With a TrackerGroup this marks all of its
components as completed.</p>

<p>Marks all of the components of this tracker as finished, which in turn means
that <code class="highlighter-rouge">tracker.completed()</code> for this will now be 1.</p>

<p>This will result in one or more <code class="highlighter-rouge">change</code> events being emitted.</p>

<h1 id="events">Events</h1>

<p>All tracker objects emit <code class="highlighter-rouge">change</code> events with the following arguments:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function (name, completed, tracker)
</code></pre></div></div>

<p><code class="highlighter-rouge">name</code> is the name of the tracker that originally emitted the event,
or if it didn’t have one, the first containing tracker group that had one.</p>

<p><code class="highlighter-rouge">completed</code> is the percent complete (as returned by <code class="highlighter-rouge">tracker.completed()</code> method).</p>

<p><code class="highlighter-rouge">tracker</code> is the tracker object that you are listening for events on.</p>

<h1 id="trackergroup">TrackerGroup</h1>

<ul>
  <li>
    <p>var tracker = new TrackerGroup(<strong>name</strong>)</p>

    <ul>
      <li><strong>name</strong> <em>(optional)</em> - The name of this tracker group, used in change
notifications if the component updating didn’t have a name. Defaults to undefined.</li>
    </ul>
  </li>
</ul>

<p>Creates a new empty tracker aggregation group. These are trackers whose
completion status is determined by the completion status of other trackers.</p>

<ul>
  <li>
    <p>tracker.addUnit(<strong>otherTracker</strong>, <strong>weight</strong>)</p>

    <ul>
      <li><strong>otherTracker</strong> - Any of the other are-we-there-yet tracker objects</li>
      <li><strong>weight</strong> <em>(optional)</em> - The weight to give the tracker, defaults to 1.</li>
    </ul>
  </li>
</ul>

<p>Adds the <strong>otherTracker</strong> to this aggregation group. The weight determines
how long you expect this tracker to take to complete in proportion to other
units.  So for instance, if you add one tracker with a weight of 1 and
another with a weight of 2, you’re saying the second will take twice as long
to complete as the first.  As such, the first will account for 33% of the
completion of this tracker and the second will account for the other 67%.</p>

<p>Returns <strong>otherTracker</strong>.</p>

<ul>
  <li>var subGroup = tracker.newGroup(<strong>name</strong>, <strong>weight</strong>)</li>
</ul>

<p>The above is exactly equivalent to:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">var</span> <span class="nx">subGroup</span> <span class="o">=</span> <span class="nx">tracker</span><span class="p">.</span><span class="nx">addUnit</span><span class="p">(</span><span class="k">new</span> <span class="nx">TrackerGroup</span><span class="p">(</span><span class="nx">name</span><span class="p">),</span> <span class="nx">weight</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>var subItem = tracker.newItem(<strong>name</strong>, <strong>todo</strong>, <strong>weight</strong>)</li>
</ul>

<p>The above is exactly equivalent to:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">var</span> <span class="nx">subItem</span> <span class="o">=</span> <span class="nx">tracker</span><span class="p">.</span><span class="nx">addUnit</span><span class="p">(</span><span class="k">new</span> <span class="nx">Tracker</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">todo</span><span class="p">),</span> <span class="nx">weight</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>var subStream = tracker.newStream(<strong>name</strong>, <strong>todo</strong>, <strong>weight</strong>)</li>
</ul>

<p>The above is exactly equivalent to:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">var</span> <span class="nx">subStream</span> <span class="o">=</span> <span class="nx">tracker</span><span class="p">.</span><span class="nx">addUnit</span><span class="p">(</span><span class="k">new</span> <span class="nx">TrackerStream</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">todo</span><span class="p">),</span> <span class="nx">weight</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>console.log( tracker.debug() )</li>
</ul>

<p>Returns a tree showing the completion of this tracker group and all of its
children, including recursively entering all of the children.</p>

<h1 id="tracker">Tracker</h1>

<ul>
  <li>
    <p>var tracker = new Tracker(<strong>name</strong>, <strong>todo</strong>)</p>

    <ul>
      <li><strong>name</strong> <em>(optional)</em> The name of this counter to report in change
events.  Defaults to undefined.</li>
      <li><strong>todo</strong> <em>(optional)</em> The amount of work todo (a number). Defaults to 0.</li>
    </ul>
  </li>
</ul>

<p>Ordinarily these are constructed as a part of a tracker group (via
<code class="highlighter-rouge">newItem</code>).</p>

<ul>
  <li>var completed = tracker.completed()</li>
</ul>

<p>Returns the ratio of completed work to work to be done. Range of 0 to 1. If
total work to be done is 0 then it will return 0.</p>

<ul>
  <li>
    <p>tracker.addWork(<strong>todo</strong>)</p>

    <ul>
      <li><strong>todo</strong> A number to add to the amount of work to be done.</li>
    </ul>
  </li>
</ul>

<p>Increases the amount of work to be done, thus decreasing the completion
percentage.  Triggers a <code class="highlighter-rouge">change</code> event.</p>

<ul>
  <li>
    <p>tracker.completeWork(<strong>completed</strong>)</p>

    <ul>
      <li><strong>completed</strong> A number to add to the work complete</li>
    </ul>
  </li>
</ul>

<p>Increase the amount of work complete, thus increasing the completion percentage.
Will never increase the work completed past the amount of work todo. That is,
percentages &gt; 100% are not allowed. Triggers a <code class="highlighter-rouge">change</code> event.</p>

<ul>
  <li>tracker.finish()</li>
</ul>

<p>Marks this tracker as finished, tracker.completed() will now be 1. Triggers
a <code class="highlighter-rouge">change</code> event.</p>

<h1 id="trackerstream">TrackerStream</h1>

<ul>
  <li>
    <p>var tracker = new TrackerStream(<strong>name</strong>, <strong>size</strong>, <strong>options</strong>)</p>

    <ul>
      <li><strong>name</strong> <em>(optional)</em> The name of this counter to report in change
events.  Defaults to undefined.</li>
      <li><strong>size</strong> <em>(optional)</em> The number of bytes being sent through this stream.</li>
      <li><strong>options</strong> <em>(optional)</em> A hash of stream options</li>
    </ul>
  </li>
</ul>

<p>The tracker stream object is a pass through stream that updates an internal
tracker object each time a block passes through.  It’s intended to track
downloads, file extraction and other related activities. You use it by piping
your data source into it and then using it as your data source.</p>

<p>If your data has a length attribute then that’s used as the amount of work
completed when the chunk is passed through.  If it does not (eg, object
streams) then each chunk counts as completing 1 unit of work, so your size
should be the total number of objects being streamed.</p>

<ul>
  <li>
    <p>tracker.addWork(<strong>todo</strong>)</p>

    <ul>
      <li><strong>todo</strong> Increase the expected overall size by <strong>todo</strong> bytes.</li>
    </ul>
  </li>
</ul>

<p>Increases the amount of work to be done, thus decreasing the completion
percentage.  Triggers a <code class="highlighter-rouge">change</code> event.</p>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
